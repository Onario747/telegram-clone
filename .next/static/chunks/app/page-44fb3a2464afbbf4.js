(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7033:function(e,a,t){Promise.resolve().then(t.bind(t,4187))},7384:function(e,a,t){"use strict";t.d(a,{F:function(){return o},ThemeProvider:function(){return r}});var s=t(7437),n=t(2265);let i=(0,n.createContext)();function r(e){let{children:a}=e,[t,r]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=localStorage.getItem("theme");e?r("dark"===e):r(window.matchMedia("(prefers-color-scheme: dark)").matches)},[]),(0,s.jsx)(i.Provider,{value:{isDarkMode:t,toggleTheme:()=>{r(!t),localStorage.setItem("theme",t?"light":"dark")}},children:a})}let o=()=>(0,n.useContext)(i)},4187:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return eo}});var s={};t.r(s);var n=t(7437),i=t(2265),r=t(3464),o=t(8614),l=t(9064),c=t(5790),d=t(7384),u=t(6126),h=t.n(u),m=t(3145);function p(e){let{phoneNumber:a,verificationCode:t,sessionData:s,loading:i,loginStep:r,onPhoneNumberChange:o,onVerificationCodeChange:l,onInitiateLogin:u,onVerifyCode:p,onBackToPhone:g}=e,{isDarkMode:_}=(0,d.F)();return(0,n.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"".concat(h().loginContainer," ").concat(_?h().dark:h().light),children:[(0,n.jsxs)("div",{className:h().loginHeader,children:[(0,n.jsx)(m.default,{src:"/telegram-logo.svg",alt:"Telegram Logo",className:h().logo,width:120,height:120,priority:!0}),(0,n.jsx)("h1",{children:"Sign in to Telegram"}),(0,n.jsx)("p",{children:"Please confirm your country code and enter your phone number."})]}),"phone"===r?(0,n.jsxs)("div",{className:h().phoneStep,children:[(0,n.jsx)("h2",{children:"Enter your phone number"}),(0,n.jsx)("div",{className:h().inputGroup,children:(0,n.jsx)("input",{type:"tel",value:a,onChange:e=>{o(e.target.value.replace(/[^\d\s+]/g,""))},placeholder:"+1 234 567 8900",disabled:i,className:h().phoneInput,maxLength:15})}),(0,n.jsx)("button",{onClick:u,disabled:i||!a||a.length<10,className:h().submitButton,children:i?"Sending...":"Send Code"})]}):(0,n.jsxs)("div",{className:h().codeStep,children:[(0,n.jsx)("h2",{children:"Enter verification code"}),(0,n.jsx)("div",{className:h().inputGroup,children:(0,n.jsx)("input",{type:"text",value:t,onChange:e=>{l(e.target.value.replace(/\D/g,""))},placeholder:"Enter code",disabled:i,className:h().phoneInput,maxLength:5})}),(0,n.jsxs)("p",{className:h().phoneNumber,children:["Code sent to ",a]}),(0,n.jsxs)("div",{className:h().buttonGroup,children:[(0,n.jsx)("button",{onClick:g,disabled:i,className:h().backButton,children:"Back"}),(0,n.jsx)("button",{onClick:p,disabled:i||!t,className:h().submitButton,children:i?"Verifying...":"Verify"})]})]})]})}var g=t(7996),_=t(9891),f=t.n(_);function v(e){let{searchQuery:a,recentSearches:t=[],results:s,loading:i,onSelectResult:r,onClearRecent:o}=e;return a||0!==t.length?(0,n.jsx)(c.E.div,{className:f().autocompleteContainer,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:i?(0,n.jsxs)("div",{className:f().loadingState,children:[(0,n.jsx)("div",{className:f().loadingSpinner}),(0,n.jsx)("span",{children:"Searching..."})]}):a?(0,n.jsxs)(n.Fragment,{children:[s.users.length>0&&(0,n.jsxs)("div",{className:f().section,children:[(0,n.jsxs)("div",{className:f().sectionHeader,children:[(0,n.jsx)(g.fzv,{}),(0,n.jsx)("span",{children:"Users"})]}),s.users.map(e=>{var a,t,s;return(0,n.jsxs)(c.E.div,{className:f().resultItem,onClick:()=>r({...e,type:"User"}),initial:{opacity:0},animate:{opacity:1},whileHover:{backgroundColor:"var(--hover-background)"},children:[(null===(a=e.profilePictures)||void 0===a?void 0:a[0])?(0,n.jsx)("img",{src:e.profilePictures[0].fileReference,alt:e.username,className:f().avatar}):(0,n.jsx)("div",{className:f().avatarPlaceholder,children:(null===(t=e.firstName)||void 0===t?void 0:t[0])||(null===(s=e.username)||void 0===s?void 0:s[0])}),(0,n.jsxs)("div",{className:f().resultInfo,children:[(0,n.jsxs)("div",{className:f().name,children:[e.firstName," ",e.lastName]}),(0,n.jsxs)("div",{className:f().username,children:["@",e.username]})]})]},e.id)})]}),s.channels.length>0&&(0,n.jsxs)("div",{className:f().section,children:[(0,n.jsxs)("div",{className:f().sectionHeader,children:[(0,n.jsx)(g.wBW,{}),(0,n.jsx)("span",{children:"Channels"})]}),s.channels.map(e=>(0,n.jsxs)(c.E.div,{className:f().resultItem,onClick:()=>r({...e,type:"Channel"}),initial:{opacity:0},animate:{opacity:1},whileHover:{backgroundColor:"var(--hover-background)"},children:[e.channelPicture?(0,n.jsx)("img",{src:e.channelPicture.fileReference,alt:e.title,className:f().avatar}):(0,n.jsx)("div",{className:f().avatarPlaceholder,children:e.title[0]}),(0,n.jsxs)("div",{className:f().resultInfo,children:[(0,n.jsx)("div",{className:f().name,children:e.title}),(0,n.jsxs)("div",{className:f().username,children:[e.participants.toLocaleString()," members"]})]})]},e.id))]}),0===s.users.length&&0===s.channels.length&&(0,n.jsxs)("div",{className:f().noResults,children:['No results found for "',a,'"']})]}):(0,n.jsxs)("div",{className:f().section,children:[(0,n.jsxs)("div",{className:f().sectionHeader,children:[(0,n.jsx)(g.TCC,{}),(0,n.jsx)("span",{children:"Recent Searches"}),t.length>0&&(0,n.jsx)("button",{className:f().clearButton,onClick:o,children:"Clear"})]}),t.map(e=>(0,n.jsxs)(c.E.div,{className:f().resultItem,onClick:()=>r(e),whileHover:{backgroundColor:"var(--hover-background)"},children:[e.profilePicture?(0,n.jsx)("img",{src:e.profilePicture.fileReference,alt:e.username||e.title,className:f().avatar}):(0,n.jsx)("div",{className:f().avatarPlaceholder,children:(e.username||e.title)[0]}),(0,n.jsxs)("div",{className:f().resultInfo,children:[(0,n.jsx)("div",{className:f().name,children:"Channel"===e.type?e.title:"".concat(e.firstName," ").concat(e.lastName)}),(0,n.jsx)("div",{className:f().username,children:"Channel"===e.type?"".concat(e.participants.toLocaleString()," members"):"@".concat(e.username)})]})]},e.id))]})}):null}var x=t(1360),j=t.n(x);function S(e){let{value:a,onChange:t,onSearch:s,onSelectResult:r,results:o,loading:l}=e,[c,d]=(0,i.useState)(!1),u=(0,i.useRef)(null),h=(0,i.useRef)(null),m=(0,i.useCallback)(e=>{h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{e.trim()&&s()},300)},[s]);(0,i.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e),h.current&&clearTimeout(h.current)}},[]);let[p,_]=(0,i.useState)(()=>{{let e=localStorage.getItem("recentSearches");return e?JSON.parse(e):[]}});return(0,n.jsxs)("div",{className:j().searchBar,ref:u,children:[(0,n.jsxs)("div",{className:j().searchInput,children:[(0,n.jsx)(g.jRj,{className:j().searchIcon}),(0,n.jsx)("input",{type:"text",value:a,onChange:e=>{let a=e.target.value;t(a),m(a),d(!0)},onFocus:()=>d(!0),placeholder:"Search"})]}),c&&(0,n.jsx)(v,{searchQuery:a,recentSearches:p,results:o,loading:l,onSelectResult:e=>{let a=[e,...p.filter(a=>a.id!==e.id).slice(0,4)];_(a),localStorage.setItem("recentSearches",JSON.stringify(a)),r(e),d(!1)},onClearRecent:()=>{_([]),localStorage.removeItem("recentSearches")}})]})}function N(e){let{users:a,channels:t,onSelect:s,onlineUsers:i}=e,r=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?";return(0,n.jsxs)("div",{className:j().searchResults,children:[a.length>0&&(0,n.jsxs)("div",{className:j().searchSection,children:[(0,n.jsx)("h3",{className:j().searchSectionTitle,children:"Users"}),a.map(e=>{var a;return(0,n.jsxs)(c.E.div,{className:j().searchResultItem,onClick:()=>s({...e,type:"User"}),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},children:[(null===(a=e.profilePictures)||void 0===a?void 0:a[0])?(0,n.jsx)("img",{src:e.profilePictures[0].fileReference,alt:e.username,className:j().profileImage,onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):(0,n.jsx)("div",{className:j().profileImagePlaceholder,children:r("".concat(e.firstName," ").concat(e.lastName))}),(0,n.jsxs)("div",{className:j().chatInfo,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:j().username,children:[e.firstName," ",e.lastName]}),(0,n.jsx)("div",{className:j().lastMessage,children:e.username?"@".concat(e.username):e.phone})]}),i.has(e.id)&&(0,n.jsx)("div",{className:j().onlineIndicator})]})]},e.id)})]}),t.length>0&&(0,n.jsxs)("div",{className:j().searchSection,children:[(0,n.jsx)("h3",{className:j().searchSectionTitle,children:"Channels"}),t.map(e=>(0,n.jsxs)(c.E.div,{className:j().searchResultItem,onClick:()=>s({...e,type:"Channel"}),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.channelPicture?(0,n.jsx)("img",{src:e.channelPicture.fileReference,alt:e.title,className:j().profileImage,onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):(0,n.jsx)("div",{className:j().profileImagePlaceholder,children:r(e.title)}),(0,n.jsx)("div",{className:j().chatInfo,children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:j().username,children:e.title}),(0,n.jsxs)("div",{className:j().lastMessage,children:[e.username?"@".concat(e.username):""," â€¢"," ",e.participants.toLocaleString()," members"]})]})})]},e.id))]}),0===a.length&&0===t.length&&(0,n.jsx)("div",{className:j().noResults,children:"No results found"})]})}function C(e){let{searchQuery:a,searchResults:t,onlineUsers:i,chatList:r,onSearchQueryChange:o,onSearch:l,onChatSelect:u,onRefreshChats:h,onMenuClick:m,loading:p}=e,{isDarkMode:_}=(0,d.F)(),f=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?",v=[...r.filter(e=>null!==e.username&&"ChatForbidden"!==e.type)].sort((e,a)=>{var t,s;if(e.pinned!==a.pinned)return a.pinned-e.pinned;let n=(null===(t=e.latestMessage)||void 0===t?void 0:t.date)||0;return((null===(s=a.latestMessage)||void 0===s?void 0:s.date)||0)-n});return(0,n.jsxs)("div",{className:"".concat(j().sidebar," ").concat(_?j().dark:j().light),children:[(0,n.jsxs)("div",{className:j().sidebarHeader,children:[(0,n.jsxs)("div",{className:j().headerTop,children:[(0,n.jsx)("button",{className:j().menuButton,onClick:m,children:(0,n.jsx)(g.cur,{size:24})}),(0,n.jsx)("h2",{children:"Telegram"})]}),(0,n.jsx)(S,{value:a,onChange:o,onSearch:l,onSelectResult:u,results:t,loading:p})]}),a?(0,n.jsx)(N,{users:t.users,channels:t.channels,onSelect:u,onlineUsers:i}):(0,n.jsxs)("div",{className:j().chatList,children:[v.map(e=>(0,n.jsxs)(c.E.div,{className:j().chatItem,onClick:()=>u(e),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.profileImage?(0,n.jsx)("img",{src:e.profileImage,alt:e.title,className:j().profileImage,onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):(0,n.jsx)("div",{className:j().profileImagePlaceholder,children:f(e.title)}),(0,n.jsxs)("div",{className:j().chatInfo,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:j().username,children:[e.title," ",e.pinned&&(0,n.jsx)(s.FiThumbtack,{size:14})]}),e.latestMessage&&(0,n.jsx)("div",{className:j().lastMessage,children:e.latestMessage.text||"No messages yet"})]}),e.unreadMessagesCount>0&&(0,n.jsx)("span",{className:j().unreadBadge,children:e.unreadMessagesCount})]})]},e.chatRoomId)),0===v.length&&(0,n.jsx)("div",{className:j().noChats,children:"No chats available"})]})]})}var b=t(4949),y=t.n(b);function P(e){let{message:a,onReact:t}=e,[s,r]=(0,i.useState)(!1);return(0,n.jsxs)(c.E.div,{className:"".concat(y().messageContainer," ").concat("fromId"in a?y().received:y().sent),initial:{opacity:0,y:20},animate:{opacity:1,y:0},onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[(0,n.jsxs)("div",{className:y().messageContent,children:[(0,n.jsx)("div",{className:y().messageText,children:a.message}),(0,n.jsx)("div",{className:y().messageInfo,children:(0,n.jsx)("span",{className:y().messageTime,children:new Date(1e3*a.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})})]}),s&&(0,n.jsxs)("div",{className:y().optionsMenu,children:[(0,n.jsx)("button",{onClick:()=>t(a.id,""),children:(0,n.jsx)(g.jMy,{})}),(0,n.jsx)("button",{children:(0,n.jsx)(g.A8q,{})})]})]})}var I=t(2768),k=t(4320),B=t.n(k);function E(e){let{value:a,onChange:t,onSend:s}=e;return(0,n.jsxs)("div",{className:B().messageInput,children:[(0,n.jsx)("button",{className:B().emojiButton,children:(0,n.jsx)(I.HxL,{})}),(0,n.jsx)("input",{type:"text",value:a,onChange:e=>t(e.target.value),placeholder:"Type a message...",className:B().input,onKeyUp:e=>"Enter"===e.key&&s()}),(0,n.jsx)("button",{onClick:s,className:B().sendButton,children:(0,n.jsx)(I.yhK,{})})]})}var A=t(967),w=t.n(A);function M(e){var a;let{chat:t,onBackClick:s,onMenuClick:i,isMobile:r,onProfileClick:o}=e;return(0,n.jsxs)("div",{className:w().chatHeader,children:[r&&(0,n.jsx)("button",{className:w().backButton,onClick:s,"aria-label":"Back",children:(0,n.jsx)(g.Ao2,{size:24})}),(0,n.jsxs)("div",{className:w().chatInfo,onClick:()=>o(t),style:{cursor:"pointer"},children:[t.profilePhoto?(0,n.jsx)("img",{src:(a=t.profilePhoto)?a.startsWith("data:")?a:"data:image/jpeg;base64,".concat(a):null,alt:t.username,className:w().chatAvatar,onError:e=>{e.target.onerror=null,e.target.style.display="none";let a=document.createElement("div");a.className=w().chatAvatarPlaceholder,a.textContent=t.initial||"?",e.target.parentNode.appendChild(a)}}):(0,n.jsx)("div",{className:w().chatAvatarPlaceholder,children:t.initial||"?"}),(0,n.jsxs)("div",{className:w().chatDetails,children:[(0,n.jsx)("h2",{children:t.username||t.title||"Unknown"}),(0,n.jsx)("p",{children:"Channel"===t.type?"Channel":"User"})]})]}),(0,n.jsx)("button",{className:w().menuButton,onClick:i,"aria-label":"Menu",children:(0,n.jsx)(g.cur,{size:24})})]})}var U=t(917),T=t.n(U);function Z(e){let{onFileSelect:a}=e,t=(0,i.useRef)(null);return(0,n.jsxs)("div",{className:T().fileUpload,children:[(0,n.jsx)("button",{onClick:()=>{var e;null===(e=t.current)||void 0===e||e.click()},className:T().uploadButton,children:(0,n.jsx)(I.T24,{})}),(0,n.jsx)("input",{type:"file",ref:t,onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&a(s)},style:{display:"none"},accept:"image/*,audio/*,video/*,application/*"})]})}var R=t(4966),L=t.n(R);function F(e){let{isRecording:a,onStartRecording:t,onStopRecording:s}=e,r=(0,i.useRef)(null),o=(0,i.useRef)([]),[l,c]=(0,i.useState)(0),d=(0,i.useRef)(null),u=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});r.current=new MediaRecorder(e),r.current.ondataavailable=e=>{o.current.push(e.data)},r.current.onstop=()=>{let a=new Blob(o.current,{type:"audio/webm"});o.current=[],s(a),e.getTracks().forEach(e=>e.stop()),clearInterval(d.current),c(0)},r.current.start(),t(),d.current=setInterval(()=>{c(e=>e+1)},1e3)}catch(e){console.error("Error accessing microphone:",e)}};return(0,n.jsxs)("div",{className:L().voiceRecorder,children:[(0,n.jsx)("button",{className:"".concat(L().recordButton," ").concat(a?L().recording:""),onClick:a?()=>{var e;(null===(e=r.current)||void 0===e?void 0:e.state)==="recording"&&r.current.stop()}:u,children:a?(0,n.jsx)(I.Wcw,{}):(0,n.jsx)(I.zXg,{})}),a&&(0,n.jsx)("span",{className:L().duration,children:"".concat(Math.floor(l/60),":").concat((l%60).toString().padStart(2,"0"))})]})}var H=t(4785),G=t.n(H),V=t(6923),O=t.n(V);function D(e){let{chatId:a,onEnd:t}=e,s=(0,i.useRef)(null),r=(0,i.useRef)(null),o=(0,i.useRef)(null),[l,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(!1);(0,i.useEffect)(()=>(h(),()=>{m()}),[]);let h=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});s.current&&(s.current.srcObject=e),o.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),e.getTracks().forEach(a=>{o.current.addTrack(a,e)}),o.current.ontrack=e=>{r.current&&(r.current.srcObject=e.streams[0])}}catch(e){console.error("Error accessing media devices:",e)}},m=()=>{var e,a;(null===(e=s.current)||void 0===e?void 0:e.srcObject)&&s.current.srcObject.getTracks().forEach(e=>e.stop()),null===(a=o.current)||void 0===a||a.close()};return(0,n.jsxs)("div",{className:O().videoCall,children:[(0,n.jsxs)("div",{className:O().controls,children:[(0,n.jsx)("button",{onClick:()=>{var e;(null===(e=s.current)||void 0===e?void 0:e.srcObject)&&(s.current.srcObject.getAudioTracks().forEach(e=>{e.enabled=!e.enabled}),c(!l))},className:O().controlButton,children:l?(0,n.jsx)(I.qL9,{}):(0,n.jsx)(I.zXg,{})}),(0,n.jsx)("button",{onClick:()=>{var e;(null===(e=s.current)||void 0===e?void 0:e.srcObject)&&(s.current.srcObject.getVideoTracks().forEach(e=>{e.enabled=!e.enabled}),u(!d))},className:O().controlButton,children:d?(0,n.jsx)(I.S7p,{}):(0,n.jsx)(I.giN,{})}),(0,n.jsx)("button",{onClick:t,className:O().endCall,children:(0,n.jsx)(I.bjh,{})})]}),(0,n.jsxs)("div",{className:O().videos,children:[(0,n.jsx)(G(),{ref:s,mirrored:!0,className:O().localVideo,audio:!1}),(0,n.jsx)("video",{ref:r,className:O().remoteVideo,autoPlay:!0,playsInline:!0})]})]})}var z=t(905),J=t.n(z),Q=t(1254),X=t.n(Q);let Y="https://xelegram-m5kh.onrender.com";function W(e){var a;let{user:t,onClose:s,sessionString:o,onUpdate:d}=e,[u,h]=(0,i.useState)(!1),[m,p]=(0,i.useState)({firstName:(null==t?void 0:t.firstName)||"",lastName:(null==t?void 0:t.lastName)||"",username:(null==t?void 0:t.username)||"",bio:(null==t?void 0:t.bio)||""}),_=(0,i.useRef)(null),f=e=>{let{name:a,value:t}=e.target;p(e=>({...e,[a]:t}))},v=()=>{let e={};return Object.keys(m).forEach(a=>{m[a]!==(t[a]||"")&&(e[a]=m[a])}),e},x=async e=>{var a,n,i;e.preventDefault(),h(!0);let c=l.ZP.loading("Updating profile...");try{let e=v();if(0===Object.keys(e).length){l.ZP.success("No changes to update",{id:c}),s();return}let n=await r.Z.put("".concat(Y,"/t/api/user/edit"),{sessionString:o,...e});(null===(a=n.data)||void 0===a?void 0:a.result)&&(n.data.result.username!==t.username&&localStorage.setItem("telegramUserName",n.data.result.username),l.ZP.success("Profile updated successfully!",{id:c}),null==d||d({...t,...n.data.result,firstName:n.data.result.firstName||"",lastName:n.data.result.lastName||"",username:n.data.result.username||"",bio:n.data.result.bio||"",profilePhoto:t.profilePhoto}),s())}catch(e){console.error("Failed to update profile:",e),l.ZP.error((null===(i=e.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.error)||"Failed to update profile",{id:c})}finally{h(!1)}},j=async e=>{var a,s,n;let i=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!i)return;if(!i.type.startsWith("image/")){l.ZP.error("Please select an image file");return}if(i.size>5242880){l.ZP.error("Image size should be less than 5MB");return}let c=l.ZP.loading("Uploading profile photo...");try{let e=new FormData;e.append("sessionString",o),e.append("file",i),(await r.Z.put("".concat(Y,"/t/api/user/edit/image"),e,{headers:{"Content-Type":"multipart/form-data"}})).data&&(l.ZP.success("Profile photo updated!",{id:c}),null==d||d({...t,profilePhoto:URL.createObjectURL(i)}))}catch(e){console.error("Failed to upload photo:",e),l.ZP.error((null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.error)||"Failed to upload photo",{id:c})}};return(0,n.jsxs)(c.E.div,{className:X().editProfilePanel,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"tween",duration:.3},children:[(0,n.jsxs)("div",{className:X().header,children:[(0,n.jsx)("button",{className:X().backButton,onClick:s,disabled:u,children:(0,n.jsx)(g.Ao2,{size:24})}),(0,n.jsx)("h2",{children:"Edit Profile"}),(0,n.jsx)("button",{className:X().saveButton,onClick:x,disabled:u,children:(0,n.jsx)(g.UgA,{size:24})})]}),(0,n.jsxs)("form",{onSubmit:x,className:X().form,children:[(0,n.jsxs)("div",{className:X().photoSection,children:[(0,n.jsxs)("div",{className:X().photoContainer,children:[(null==t?void 0:t.profilePhoto)?(0,n.jsx)("img",{src:t.profilePhoto,alt:m.username||"Profile",className:X().profilePhoto}):(0,n.jsx)("div",{className:X().profilePhotoPlaceholder,children:(a=m.username)?a.charAt(0).toUpperCase():"?"}),(0,n.jsx)("button",{type:"button",className:X().uploadOverlay,onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.click()},children:(0,n.jsx)(g.tBf,{size:24})})]}),(0,n.jsx)("input",{ref:_,type:"file",accept:"image/*",onChange:j,style:{display:"none"}}),(0,n.jsx)("button",{type:"button",className:X().changePhotoButton,onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.click()},children:"Change Profile Photo"})]}),(0,n.jsxs)("div",{className:X().inputGroup,children:[(0,n.jsx)("label",{children:"First Name"}),(0,n.jsx)("input",{type:"text",name:"firstName",value:m.firstName,onChange:f,placeholder:"First Name"})]}),(0,n.jsxs)("div",{className:X().inputGroup,children:[(0,n.jsx)("label",{children:"Last Name"}),(0,n.jsx)("input",{type:"text",name:"lastName",value:m.lastName,onChange:f,placeholder:"Last Name"})]}),(0,n.jsxs)("div",{className:X().inputGroup,children:[(0,n.jsx)("label",{children:"Username"}),(0,n.jsx)("input",{type:"text",name:"username",value:m.username,onChange:f,placeholder:"Username"}),(0,n.jsx)("span",{className:X().hint,children:"You can choose a username on Telegram. If you do, other people will be able to find you by this username and contact you without needing your phone number."})]}),(0,n.jsxs)("div",{className:X().inputGroup,children:[(0,n.jsx)("label",{children:"Bio"}),(0,n.jsx)("textarea",{name:"bio",value:m.bio,onChange:f,placeholder:"Add a few words about yourself",maxLength:70}),(0,n.jsx)("span",{className:X().hint,children:"Any details such as age, occupation or city. Example: 23 y.o. designer from San Francisco."})]})]})]})}let K="https://xelegram-m5kh.onrender.com";function q(e){var a;let{user:t,onClose:s,sessionString:d}=e,[u,h]=(0,i.useState)(null),[m,p]=(0,i.useState)(!0),[_,f]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=async()=>{try{let e;"Channel"===t.type?(e=await r.Z.post("".concat(K,"/t/api/channel/info"),{sessionString:d,channelUsername:t.username})).data&&h({...e.data,type:"Channel"}):(e=await r.Z.post("".concat(K,"/t/api/user/info"),{sessionString:d,userUsername:t.username})).data&&h(e.data)}catch(e){l.ZP.error("Failed to load information"),console.error("Error fetching info:",e)}finally{p(!1)}};t.username&&d&&e()},[t.username,d,t.type]),(0,n.jsxs)(c.E.div,{className:J().profilePanel,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"tween",duration:.3},children:[(0,n.jsx)("button",{className:J().closeButton,onClick:s,children:(0,n.jsx)(g.q5L,{size:24})}),(0,n.jsxs)("div",{className:J().profileHeader,children:[t.profilePhoto?(0,n.jsx)("img",{src:(a=t.profilePhoto).startsWith("data:")?a:"data:image/jpeg;base64,".concat(a),alt:t.username,className:J().profileImage,onError:e=>{e.target.onerror=null,e.target.src="",e.target.style.display="none";let a=document.createElement("div");a.className=J().profileImagePlaceholder,a.textContent=t.username[0].toUpperCase(),e.target.parentNode.appendChild(a)}}):(0,n.jsx)("div",{className:J().profileImagePlaceholder,children:t.username[0].toUpperCase()}),(0,n.jsxs)("h2",{children:[t.firstName," ",t.lastName]}),(0,n.jsxs)("p",{className:J().username,children:["@",t.username]})]}),m?(0,n.jsx)("div",{className:J().loading,children:"Loading information..."}):u?(0,n.jsx)("div",{className:J().profileInfo,children:"Channel"===u.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:J().infoGroup,children:[(0,n.jsx)("h3",{children:"Channel Name"}),(0,n.jsx)("p",{children:u.title})]}),u.about&&(0,n.jsxs)("div",{className:J().infoGroup,children:[(0,n.jsx)("h3",{children:"Description"}),(0,n.jsx)("p",{children:u.about})]}),void 0!==u.participantsCount&&(0,n.jsxs)("div",{className:J().infoGroup,children:[(0,n.jsx)("h3",{children:"Members"}),(0,n.jsx)("p",{children:u.participantsCount})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:J().infoGroup,children:[(0,n.jsx)("h3",{children:"Name"}),(0,n.jsx)("p",{children:"".concat(u.firstName||""," ").concat(u.lastName||"")})]}),u.bio&&(0,n.jsxs)("div",{className:J().infoGroup,children:[(0,n.jsx)("h3",{children:"Bio"}),(0,n.jsx)("p",{children:u.bio})]}),u.phone&&(0,n.jsxs)("div",{className:J().infoGroup,children:[(0,n.jsx)("h3",{children:"Phone"}),(0,n.jsx)("p",{children:u.phone})]}),(0,n.jsxs)("div",{className:J().infoGroup,children:[(0,n.jsx)("h3",{children:"Username"}),(0,n.jsxs)("p",{children:["@",u.username]})]})]})}):(0,n.jsx)("div",{className:J().error,children:"Failed to load information"}),(0,n.jsxs)("div",{className:J().actions,children:[(0,n.jsx)("button",{className:J().actionButton,onClick:()=>f(!0),children:"Edit Profile"}),(0,n.jsx)("button",{className:J().actionButton,children:"Send Message"}),(0,n.jsx)("button",{className:J().actionButton,children:"Share Contact"})]}),(0,n.jsx)(o.M,{children:_&&(0,n.jsx)(W,{user:u,onClose:()=>f(!1),sessionString:d,onUpdate:e=>{h(e)}})})]})}function $(e){var a;let{selectedChat:t,messages:s,loading:c,hasMore:u,onLoadMore:h,onSendMessage:m,onSendFile:p,onSendVoice:g,onBackClick:_,onMenuClick:f,isMobile:v,onReactToMessage:x,onInitiateVideoCall:j,sessionString:S,onChatUpdate:N}=e,{isDarkMode:C}=(0,d.F)(),[b,y]=(0,i.useState)(""),[I,k]=(0,i.useState)(!1),[B,A]=(0,i.useState)(!1),[U,T]=(0,i.useState)(!1),[R,L]=(0,i.useState)(!1),[H,G]=(0,i.useState)((null==t?void 0:t.isMember)!==!1),[V,O]=(0,i.useState)(!0),z=(0,i.useRef)(null),J=(0,i.useRef)(null);(0,i.useEffect)(()=>{(null==t?void 0:t.type)==="Channel"?(G(!1!==t.isMember),O(!1!==t.canPost)):(G(!0),O(!0))},[t]);let Q=async()=>{if(!S||!(null==t?void 0:t.username))return;L(!0);let e=l.ZP.loading("Joining channel...");try{(await r.Z.post("".concat("https://xelegram-m5kh.onrender.com","/t/api/channel/join"),{sessionString:S,groupUsername:t.username})).data&&(G(!0),O(!0),l.ZP.success("Successfully joined channel!",{id:e}))}catch(t){var a,s;console.error("Failed to join channel:",t),l.ZP.error((null===(s=t.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Failed to join channel",{id:e})}finally{L(!1)}},X=()=>{var e;null===(e=z.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return((0,i.useEffect)(()=>{X()},[s]),t)?(0,n.jsxs)("div",{className:"".concat(w().chatArea," ").concat(C?w().dark:w().light),children:[(0,n.jsx)(M,{chat:{...t,username:t.username||t.title||"Unknown",initial:(a=t.username||t.title)?a.charAt(0).toUpperCase():"?"},onBackClick:_,onMenuClick:f,isMobile:v,onProfileClick:()=>T(!0)}),(0,n.jsxs)("div",{className:w().messagesContainer,ref:J,onScroll:e=>{let{scrollTop:a}=e.target;a<100&&u&&!c&&h()},children:[c?(0,n.jsx)("div",{className:w().loadingIndicator,children:"Loading messages..."}):s&&0!==s.length&&s.some(e=>e.message)?s.filter(e=>e.message).sort((e,a)=>e.date-a.date).map(e=>(0,n.jsx)(P,{message:e,onReact:x},e.id)):(0,n.jsx)("div",{className:w().noMessagesContainer,children:(0,n.jsxs)("div",{className:w().noMessagesContent,children:[(0,n.jsx)("h3",{children:"Start a conversation"}),(0,n.jsxs)("p",{children:["Say hello to ",t.title||t.username]}),(0,n.jsx)("button",{className:w().startChatButton,onClick:()=>{let e=document.querySelector("textarea");e&&(e.focus(),e.value="Hi! \uD83D\uDC4B",y("Hi! \uD83D\uDC4B"))},children:"Send Message"})]})}),(0,n.jsx)("div",{ref:z})]}),(0,n.jsx)("div",{className:w().inputArea,children:"Channel"!==t.type||H?V?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z,{onFileSelect:p}),(0,n.jsx)(E,{value:b,onChange:y,onSend:()=>{b.trim()&&(m(b).catch(e=>{var a,t,s;(null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:null===(a=t.error)||void 0===a?void 0:a.includes("CHAT_ADMIN_REQUIRED"))?(O(!1),l.ZP.error("You need to be an admin to post in this channel")):l.ZP.error("Failed to send message")}),y(""))}}),(0,n.jsx)(F,{isRecording:I,onStartRecording:()=>k(!0),onStopRecording:e=>{k(!1),g(e)}})]}):(0,n.jsx)("div",{className:w().noPostingPermission,children:"You don't have permission to post in this channel"}):(0,n.jsx)("button",{className:w().joinButton,onClick:Q,disabled:R,children:R?"Joining...":"Join Channel"})}),B&&(0,n.jsx)(D,{chatId:t.id,onEnd:()=>A(!1)}),(0,n.jsx)(o.M,{children:U&&(0,n.jsx)(q,{user:t,onClose:()=>T(!1),sessionString:S})})]}):(0,n.jsx)("div",{className:"".concat(w().noChatSelected," ").concat(C?w().dark:w().light),children:(0,n.jsxs)("div",{className:w().noChatContent,children:[(0,n.jsx)("h2",{children:"Select a chat to start messaging"}),(0,n.jsx)("p",{children:"Choose from your existing conversations or start a new one"})]})})}t(257);var ee=t(8145),ea=t.n(ee),et=t(8751),es=t.n(et);function en(e){var a;let{onClose:t,onLogout:s,sessionString:u,username:h}=e,{isDarkMode:m,toggleTheme:p}=(0,d.F)(),[_,f]=(0,i.useState)(null),[v,x]=(0,i.useState)(!0),[j,S]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=async()=>{try{let e=await r.Z.post("".concat("https://xelegram-m5kh.onrender.com","/t/api/user/info"),{sessionString:u,userUsername:h});e.data&&f(e.data)}catch(e){l.ZP.error("Failed to load user information"),console.error("Error fetching user info:",e)}finally{x(!1)}};h&&u&&e()},[h,u]);let N={hidden:{opacity:0,y:20},visible:e=>({opacity:1,y:0,transition:{delay:.1*e,duration:.3}})};return(0,n.jsx)(c.E.div,{className:es().settingsOverlay,variants:{hidden:{opacity:0},visible:{opacity:1,transition:{duration:.3,when:"beforeChildren"}},exit:{opacity:0,transition:{duration:.2,when:"afterChildren"}}},initial:"hidden",animate:"visible",exit:"exit",children:(0,n.jsxs)(c.E.div,{className:es().settingsPanel,variants:{hidden:{x:"-100%",opacity:0,transition:{type:"tween",duration:.3}},visible:{x:0,opacity:1,transition:{type:"tween",duration:.3,ease:"easeOut"}},exit:{x:"-100%",opacity:0,transition:{type:"tween",duration:.2,ease:"easeIn"}}},children:[(0,n.jsxs)("div",{className:es().settingsHeader,children:[(0,n.jsx)("button",{className:es().backButton,onClick:t,children:(0,n.jsx)(g.Ao2,{size:24})}),(0,n.jsx)("h2",{children:"Settings"})]}),(0,n.jsxs)("div",{className:es().settingsContent,children:[v?(0,n.jsx)("div",{className:es().loading,children:"Loading profile..."}):_?(0,n.jsxs)("div",{className:es().profileSection,children:[(0,n.jsxs)("div",{className:es().profileHeader,children:[_.profilePhoto?(0,n.jsx)("img",{src:_.profilePhoto,alt:_.username,className:es().profileImage}):(0,n.jsx)("div",{className:es().profileImagePlaceholder,children:(null===(a=_.firstName)||void 0===a?void 0:a[0])||_.username[0]}),(0,n.jsx)("button",{className:es().editPhotoButton,onClick:()=>S(!0),children:(0,n.jsx)(g.IYd,{size:20})})]}),(0,n.jsxs)("div",{className:es().profileInfo,children:[(0,n.jsxs)("div",{className:es().infoGroup,children:[(0,n.jsx)("h3",{children:"Name"}),(0,n.jsx)("p",{children:"".concat(_.firstName||""," ").concat(_.lastName||"")})]}),(0,n.jsxs)("div",{className:es().infoGroup,children:[(0,n.jsx)("h3",{children:"Username"}),(0,n.jsxs)("p",{children:["@",_.username]})]}),_.bio&&(0,n.jsxs)("div",{className:es().infoGroup,children:[(0,n.jsx)("h3",{children:"Bio"}),(0,n.jsx)("p",{children:_.bio})]}),_.phone&&(0,n.jsxs)("div",{className:es().infoGroup,children:[(0,n.jsx)("h3",{children:"Phone"}),(0,n.jsx)("p",{children:_.phone})]})]})]}):(0,n.jsx)("div",{className:es().error,children:"Failed to load profile"}),(0,n.jsxs)("div",{className:es().settingsGroup,children:[(0,n.jsxs)(c.E.button,{className:es().settingsItem,onClick:()=>S(!0),children:[(0,n.jsx)(g.fzv,{size:20}),(0,n.jsx)("span",{children:"Edit Profile"})]}),(0,n.jsxs)(c.E.button,{className:es().settingsItem,onClick:p,children:[m?(0,n.jsx)(g.kXG,{size:20}):(0,n.jsx)(g.wOW,{size:20}),(0,n.jsx)("span",{children:"Theme"})]}),(0,n.jsxs)(c.E.button,{className:es().settingsItem,variants:N,initial:"hidden",animate:"visible",custom:1,whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,n.jsx)(g.bax,{size:20}),(0,n.jsx)("span",{children:"Help"})]}),(0,n.jsxs)(c.E.button,{className:es().settingsItem,variants:N,initial:"hidden",animate:"visible",custom:2,whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,n.jsx)(g.H33,{size:20}),(0,n.jsx)("span",{children:"About"})]})]}),(0,n.jsx)(c.E.button,{className:"".concat(es().settingsItem," ").concat(es().logoutButton),onClick:s,children:"Logout"})]}),(0,n.jsx)(o.M,{children:j&&_&&(0,n.jsx)(W,{user:_,onClose:()=>S(!1),sessionString:u,onUpdate:e=>{f(e)}})})]})})}let ei="https://xelegram-m5kh.onrender.com";function er(){let[e,a]=(0,i.useState)(()=>!!localStorage.getItem("telegramSession")),[t,s]=(0,i.useState)(""),[c,d]=(0,i.useState)(""),[u,h]=(0,i.useState)(()=>{{let e=localStorage.getItem("telegramSession");return e?JSON.parse(e):null}}),[m,g]=(0,i.useState)(""),[_,f]=(0,i.useState)({users:[],channels:[]}),[v,x]=(0,i.useState)(null),[j,S]=(0,i.useState)([]),[N,b]=(0,i.useState)(!1),[y,P]=(0,i.useState)(new Set),[I,k]=(0,i.useState)("phone"),[B,E]=(0,i.useState)([]),[A,w]=(0,i.useState)(!1),[M,U]=(0,i.useState)(!0),[T,Z]=(0,i.useState)(0),[R,L]=(0,i.useState)(!1),[F,H]=(0,i.useState)(!1),[G,V]=(0,i.useState)(!0),[O,D]=(0,i.useState)(!1),[z,J]=(0,i.useState)(()=>localStorage.getItem("telegramUserName")||null);(0,i.useEffect)(()=>{(async()=>{let e=localStorage.getItem("telegramSession"),t=localStorage.getItem("telegramUserName"),s=localStorage.getItem("isLoggedIn");if(e&&"true"===s){let s=JSON.parse(e);try{let e=await r.Z.post("".concat(ei,"/t/api/refresh"),{sessionString:s.sessionString});if(e.data.sessionString){let n={...s,sessionString:e.data.sessionString};localStorage.setItem("telegramSession",JSON.stringify(n)),h(n),J(t),a(!0),await Y()}else throw Error("Invalid session")}catch(e){console.error("Session refresh failed:",e),localStorage.removeItem("telegramSession"),localStorage.removeItem("telegramUserName"),localStorage.removeItem("isLoggedIn"),h(null),J(null),a(!1)}}})()},[]),(0,i.useEffect)(()=>{u&&e&&(localStorage.setItem("telegramSession",JSON.stringify(u)),localStorage.setItem("isLoggedIn","true"))},[u,e]);let Q=async()=>{let e=l.ZP.loading("Sending verification code...");try{b(!0);let a=await r.Z.post("".concat(ei,"/t/api/initiate"),{phoneNumber:t});if(a.data.response){let{phoneCodeHash:t,sessionString:s}=a.data.response;h({phoneCodeHash:t,sessionString:s}),k("code"),l.ZP.success("Verification code sent successfully!",{id:e})}}catch(n){var a,s;let t=(null===(s=n.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Failed to send verification code";console.error("Login initiation failed:",t),l.ZP.error(t,{id:e})}finally{b(!1)}},X=async()=>{let e=l.ZP.loading("Verifying code...");try{if(b(!0),!u)throw Error("Session data is missing");let{phoneCodeHash:s,sessionString:n}=u,i=await r.Z.post("".concat(ei,"/t/api/verify"),{phoneNumber:t,phoneCodeHash:s,sessionString:n,phoneCode:c});if(i.data.sessionString){let s={...u,sessionString:i.data.sessionString,phoneNumber:t};localStorage.setItem("telegramSession",JSON.stringify(s)),localStorage.setItem("telegramUserName",i.data.userName),localStorage.setItem("isLoggedIn","true"),h(s),J(i.data.userName),a(!0),l.ZP.success("Successfully logged in!",{id:e}),await Y()}}catch(t){var s,n;let a=(null===(n=t.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.error)||"Verification failed";console.error("Verification failed:",a),l.ZP.error(a,{id:e})}finally{b(!1)}},Y=async()=>{if(!(null==u?void 0:u.sessionString))return;let e=l.ZP.loading("Loading chats...");try{let a=await r.Z.post("".concat(ei,"/t/api/chats"),{sessionString:u.sessionString});a.data.chatList&&(E(a.data.chatList),l.ZP.success("Chats loaded successfully",{id:e}))}catch(e){q(e,"Failed to load chats")}},W=async()=>{if(!(null==u?void 0:u.sessionString)||!m.trim())return;D(!0);let e=l.ZP.loading("Searching...");try{let[s,n]=await Promise.all([r.Z.post("".concat(ei,"/t/api/search"),{sessionString:u.sessionString,searchQuery:m.trim()}),r.Z.post("".concat(ei,"/t/api/channel/search"),{sessionString:u.sessionString,searchQuery:m.trim()})]);if(s.data.users||n.data.channels){var a,t;f({users:s.data.users||[],channels:n.data.channels||[]});let i=((null===(a=s.data.users)||void 0===a?void 0:a.length)||0)+((null===(t=n.data.channels)||void 0===t?void 0:t.length)||0);i>0?l.ZP.success("Found ".concat(i," result").concat(1===i?"":"s"),{id:e}):l.ZP.error("No results found",{id:e})}}catch(e){await q(e,"Search failed")?await W():f({users:[],channels:[]})}finally{D(!1)}},K=(0,i.useCallback)(()=>{a(!1),h(null),J(null),S([]),E([]),x(null),localStorage.removeItem("telegramSession"),localStorage.removeItem("telegramUserName"),localStorage.removeItem("isLoggedIn"),l.ZP.success("Logged out successfully")},[]),q=(0,i.useCallback)(async(e,a)=>{var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&(null==u?void 0:u.sessionString)){if(await el(u.sessionString))return!0;K(),l.ZP.error("Session expired. Please log in again.")}else l.ZP.error(a);return!1},[null==u?void 0:u.sessionString,K]),ee=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(null==u?void 0:u.sessionString)||!e)return;w(!0);let t=l.ZP.loading("Loading messages...");try{var s;let n;switch(e.type){case"Channel":n=await r.Z.post("".concat(ei,"/t/api/channel/messages"),{sessionString:u.sessionString,channelUsername:e.username,messageIds:[],limit:50,offset:a});break;case"User":n=await r.Z.post("".concat(ei,"/t/api/user/messages"),{sessionString:u.sessionString,userUsername:e.username,limit:50,offset:a});break;case"ChatForbidden":l.ZP.error("This chat is not accessible"),w(!1);return;default:l.ZP.error("Unsupported chat type"),w(!1);return}(null==n?void 0:null===(s=n.data)||void 0===s?void 0:s.messages)&&(0===a?S(n.data.messages):S(e=>[...e,...n.data.messages]),U(50===n.data.messages.length),l.ZP.success("Messages loaded",{id:t}))}catch(t){await q(t,"Failed to load messages")&&await ee(e,a)}finally{w(!1)}},et=async()=>{if(A||!M||!v)return;let e=T+50;Z(e),await ee(v,e)},es=async e=>{if(!v||!(null==u?void 0:u.sessionString)||!e.trim())return;let a=l.ZP.loading("Sending message...");try{if(("Channel"===v.type?await r.Z.post("".concat(ei,"/t/api/channel/message"),{sessionString:u.sessionString,channelUsername:v.username,messageText:e.trim()}):await r.Z.post("".concat(ei,"/t/api/user/message"),{sessionString:u.sessionString,destination:v.username||v.phone,messageText:e.trim()})).data){let t={id:Date.now(),message:e.trim(),date:Math.floor(Date.now()/1e3),fromId:null,peerId:{userId:v.id,className:"Channel"===v.type?"PeerChannel":"PeerUser"}};S(e=>[...e,t]),l.ZP.success("Message sent!",{id:a}),await ee(v)}}catch(a){await q(a,"Failed to send message")&&await es(e)}},er=async e=>{l.ZP.error("File sending feature is coming soon!"),console.log("File to be sent:",e)},eo=async e=>{l.ZP.error("Voice message feature is coming soon!"),console.log("Voice message to be sent:",e)},el=async e=>{try{let a=await r.Z.post("".concat(ei,"/t/api/refresh"),{sessionString:e});if(a.data.sessionString)return h(e=>({...e,sessionString:a.data.sessionString})),!0;return!1}catch(e){return console.error("Session refresh failed:",e),!1}};return(0,i.useEffect)(()=>{let a;return e&&(null==u?void 0:u.sessionString)&&(a=setInterval(async()=>{await el(u.sessionString)||(K(),l.ZP.error("Session expired. Please log in again."))},18e5)),()=>{a&&clearInterval(a)}},[e,null==u?void 0:u.sessionString,K]),(0,i.useEffect)(()=>{let e=()=>{H(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.jsx)("div",{className:ea().telegramApp,children:e?(0,n.jsxs)(n.Fragment,{children:[(!v||!F)&&(0,n.jsx)("div",{className:ea().sidebar,children:(0,n.jsx)(C,{chatList:B,searchQuery:m,searchResults:_,onlineUsers:y,onSearchQueryChange:g,onSearch:W,onChatSelect:e=>{if("ChatForbidden"===e.type){l.ZP.error("This chat is not accessible");return}x(e),S([]),Z(0),U(!0),ee(e),F&&V(!1)},onRefreshChats:Y,onMenuClick:()=>L(!0),isMobile:F,loading:O})}),(v||!F)&&(0,n.jsx)("div",{className:ea().chatArea,children:(0,n.jsx)($,{selectedChat:v,messages:j,loading:A,hasMore:M,onLoadMore:et,onSendMessage:es,onSendFile:er,onSendVoice:eo,onBackClick:()=>x(null),onMenuClick:()=>L(!0),isMobile:F,sessionString:null==u?void 0:u.sessionString})}),(0,n.jsx)(o.M,{children:R&&(0,n.jsx)(en,{onClose:()=>L(!1),onLogout:K,sessionString:null==u?void 0:u.sessionString,username:z})})]}):(0,n.jsx)(p,{phoneNumber:t,verificationCode:c,loading:N,loginStep:I,onPhoneNumberChange:s,onVerificationCodeChange:d,onInitiateLogin:Q,onVerifyCode:X,onBackToPhone:()=>k("phone")})})}function eo(){return(0,n.jsx)(er,{})}},967:function(e){e.exports={chatArea:"ChatArea_chatArea__SAve1",chatHeader:"ChatArea_chatHeader__pybJr",backButton:"ChatArea_backButton__L_vZX",chatInfo:"ChatArea_chatInfo__CIswl",chatAvatar:"ChatArea_chatAvatar__sl4_5",chatAvatarPlaceholder:"ChatArea_chatAvatarPlaceholder___4CmW",chatDetails:"ChatArea_chatDetails__29Ouh",menuButton:"ChatArea_menuButton__YOCPo",messagesContainer:"ChatArea_messagesContainer__N2Gd_",loadingIndicator:"ChatArea_loadingIndicator__Xanqo",inputArea:"ChatArea_inputArea__Bn5UA",messageInput:"ChatArea_messageInput__59ifs",actionButton:"ChatArea_actionButton__y4TDo",noChatSelected:"ChatArea_noChatSelected__0D9rU",noChatContent:"ChatArea_noChatContent__psnIV",dark:"ChatArea_dark__PBMJ_",light:"ChatArea_light__8LSTl",joinButton:"ChatArea_joinButton__jjr6U",noMessagesContainer:"ChatArea_noMessagesContainer__Q0YF_",noMessagesContent:"ChatArea_noMessagesContent__aVQfM",fadeIn:"ChatArea_fadeIn__I00Dv",startChatButton:"ChatArea_startChatButton___0F96",noPostingPermission:"ChatArea_noPostingPermission__3R_gX"}},4949:function(e){e.exports={messageContainer:"MessageBubble_messageContainer__7eT1e",fadeIn:"MessageBubble_fadeIn__CpxTl",sent:"MessageBubble_sent__82yjn",received:"MessageBubble_received__prWZO",messageContent:"MessageBubble_messageContent__c63cT",messageText:"MessageBubble_messageText__J3cE1",messageInfo:"MessageBubble_messageInfo__hw7xn",messageTime:"MessageBubble_messageTime__Nd4Bx",optionsMenu:"MessageBubble_optionsMenu__ARkl0"}},4320:function(e){e.exports={messageInput:"MessageInput_messageInput__k6nqk",emojiButton:"MessageInput_emojiButton__RjejF",input:"MessageInput_input__T1DdI",sendButton:"MessageInput_sendButton__X_Nn_"}},6126:function(e){e.exports={loginContainer:"Login_loginContainer__AF_Bs",loginHeader:"Login_loginHeader__lWFuw",logo:"Login_logo__j51Od",phoneStep:"Login_phoneStep__tkfqg",codeStep:"Login_codeStep__x_D_G",inputGroup:"Login_inputGroup__kLVtJ",phoneInput:"Login_phoneInput__6AkKa",buttonGroup:"Login_buttonGroup___6VYo",submitButton:"Login_submitButton__TggZf",backButton:"Login_backButton__1Ii5r",dark:"Login_dark__7o_r6",light:"Login_light__v0DcV"}},8751:function(e){e.exports={settingsPanel:"Settings_settingsPanel__VGrzR",settingsHeader:"Settings_settingsHeader__xgBH0",backButton:"Settings_backButton__B9DsZ",settingsContent:"Settings_settingsContent__H8yeX",profileSection:"Settings_profileSection__TxFn5",profileHeader:"Settings_profileHeader__HLTsm",profileImage:"Settings_profileImage__d7Ftm",profileImagePlaceholder:"Settings_profileImagePlaceholder__ajwP2",editPhotoButton:"Settings_editPhotoButton__mF7IQ",profileInfo:"Settings_profileInfo__extKk",infoGroup:"Settings_infoGroup__VQsK_",settingsGroup:"Settings_settingsGroup__82_DL",settingsItem:"Settings_settingsItem___KHYN",logoutButton:"Settings_logoutButton__q2EBl",loading:"Settings_loading__KeQdN",error:"Settings_error__xKpaZ"}},9891:function(e){e.exports={autocompleteContainer:"SearchAutocomplete_autocompleteContainer__CmeXK",section:"SearchAutocomplete_section__Ym_lO",sectionHeader:"SearchAutocomplete_sectionHeader__Ndagl",resultItem:"SearchAutocomplete_resultItem__GDsfJ",avatar:"SearchAutocomplete_avatar__LXKEu",avatarPlaceholder:"SearchAutocomplete_avatarPlaceholder__GVHZi",resultInfo:"SearchAutocomplete_resultInfo__ss3Px",name:"SearchAutocomplete_name__5rQMh",username:"SearchAutocomplete_username__MGVlK",loadingState:"SearchAutocomplete_loadingState__V0Jmj",loadingSpinner:"SearchAutocomplete_loadingSpinner__onOg0",spin:"SearchAutocomplete_spin__7rl2H",noResults:"SearchAutocomplete_noResults__OYoAm",clearButton:"SearchAutocomplete_clearButton__IO4Y2"}},1360:function(e){e.exports={sidebar:"Sidebar_sidebar__7586C",searchBar:"Sidebar_searchBar__vcNO_",searchInput:"Sidebar_searchInput__G_xWN",searchIcon:"Sidebar_searchIcon__8Tj82",searchResults:"Sidebar_searchResults__XnpNZ",searchResultItem:"Sidebar_searchResultItem__HF25H",chatList:"Sidebar_chatList__1x72M",chatItem:"Sidebar_chatItem__iY1JT",profileImage:"Sidebar_profileImage__Q0_u4",profileImagePlaceholder:"Sidebar_profileImagePlaceholder__URLHX",chatInfo:"Sidebar_chatInfo__J8XaZ",username:"Sidebar_username__lXabE",unreadBadge:"Sidebar_unreadBadge__9_yL3",lastMessage:"Sidebar_lastMessage__dleo4",dark:"Sidebar_dark__rz8wa",light:"Sidebar_light__C_JBs",searchSection:"Sidebar_searchSection__QsRpU",searchSectionTitle:"Sidebar_searchSectionTitle__bvPCD",noResults:"Sidebar_noResults__vH_B7",onlineIndicator:"Sidebar_onlineIndicator__O0yid",sidebarHeader:"Sidebar_sidebarHeader__itazf",logoutButton:"Sidebar_logoutButton__meJbC",headerTop:"Sidebar_headerTop__V_ANz",menuButton:"Sidebar_menuButton__dwnfn",noChats:"Sidebar_noChats__CokDu"}},8145:function(e){e.exports={container:"TelegramApp_container__snmWK",telegramApp:"TelegramApp_telegramApp__dKbTn",chatContainer:"TelegramApp_chatContainer___1z2P",sidebar:"TelegramApp_sidebar__rEXFb",chatArea:"TelegramApp_chatArea__StrY1",noChatSelected:"TelegramApp_noChatSelected__0nCZ6",dark:"TelegramApp_dark__GHHEq",light:"TelegramApp_light__0JkST"}},1254:function(e){e.exports={editProfilePanel:"EditProfile_editProfilePanel__CgWvP",header:"EditProfile_header__XTSdP",backButton:"EditProfile_backButton__d8_T2",saveButton:"EditProfile_saveButton__zGJF1",form:"EditProfile_form__j1_Mz",photoSection:"EditProfile_photoSection__2zJFO",photoContainer:"EditProfile_photoContainer__CT8ff",uploadOverlay:"EditProfile_uploadOverlay__qhG2Q",profilePhoto:"EditProfile_profilePhoto__AUsMN",profilePhotoPlaceholder:"EditProfile_profilePhotoPlaceholder__4S1tE",changePhotoButton:"EditProfile_changePhotoButton__ni_TE",inputGroup:"EditProfile_inputGroup___iy5A",hint:"EditProfile_hint__25vPx"}},905:function(e){e.exports={overlay:"UserProfile_overlay__HHhTd",profileModal:"UserProfile_profileModal__8VY8p",closeButton:"UserProfile_closeButton__absHI",profileHeader:"UserProfile_profileHeader__1hH4b",profileImage:"UserProfile_profileImage__R4c8U",profileImagePlaceholder:"UserProfile_profileImagePlaceholder__UPMcL",username:"UserProfile_username__5cQHX",profileInfo:"UserProfile_profileInfo__8stJ0",infoGroup:"UserProfile_infoGroup__kjCZs",actions:"UserProfile_actions__BmGdu",actionButton:"UserProfile_actionButton__dzvYk",loading:"UserProfile_loading__HUAQh",error:"UserProfile_error__nAYER",profilePanel:"UserProfile_profilePanel__JztGt"}},917:function(e){e.exports={fileUpload:"FileUpload_fileUpload__JZalo",uploadButton:"FileUpload_uploadButton__ZIbIB"}},6923:function(e){e.exports={videoCall:"VideoCall_videoCall__5Wo4c",videos:"VideoCall_videos__tHF35",localVideo:"VideoCall_localVideo__oU_33",remoteVideo:"VideoCall_remoteVideo__MG0gD",controls:"VideoCall_controls__TecxW",controlButton:"VideoCall_controlButton__o7nfs",endCall:"VideoCall_endCall__mD_tZ"}},4966:function(e){e.exports={voiceRecorder:"VoiceRecorder_voiceRecorder__RDQwD",recordButton:"VoiceRecorder_recordButton__yeFLs",recording:"VoiceRecorder_recording__GA1FM",pulse:"VoiceRecorder_pulse__25EZY",duration:"VoiceRecorder_duration__jXS02"}}},function(e){e.O(0,[991,706,956,64,611,971,117,744],function(){return e(e.s=7033)}),_N_E=e.O()}]);